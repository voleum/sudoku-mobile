# 2.1.3 ĞĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ñ‹ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ

## Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ: ğŸ”„ Ğ’ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğµ
**Ğ”Ğ°Ñ‚Ğ° Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ°**: 19 ÑĞµĞ½Ñ‚ÑĞ±Ñ€Ñ 2025
**ĞÑ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²ĞµĞ½Ğ½Ñ‹Ğ¹**: voleum

---

## ĞĞ±Ñ‰Ğ¸Ğµ Ğ¿Ñ€Ğ¸Ğ½Ñ†Ğ¸Ğ¿Ñ‹ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ñ‹

### ğŸ¯ ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ½Ñ‹Ğµ Ñ†ĞµĞ»Ğ¸

**ĞÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ Ğ¿Ñ€Ğ¸Ğ½Ñ†Ğ¸Ğ¿Ñ‹:**
1. **ĞœĞ°ÑÑˆÑ‚Ğ°Ğ±Ğ¸Ñ€ÑƒĞµĞ¼Ğ¾ÑÑ‚ÑŒ** - Ğ»ĞµĞ³ĞºĞ¾Ğµ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ½Ğ¾Ğ²Ñ‹Ñ… Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¹
2. **Ğ¢ĞµÑÑ‚Ğ¸Ñ€ÑƒĞµĞ¼Ğ¾ÑÑ‚ÑŒ** - Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚ÑŒ unit Ğ¸ integration Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
3. **ĞŸĞ¾Ğ´Ğ´ĞµÑ€Ğ¶Ğ¸Ğ²Ğ°ĞµĞ¼Ğ¾ÑÑ‚ÑŒ** - Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾Ñ‚Ğ° Ğ²Ğ½ĞµÑĞµĞ½Ğ¸Ñ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğ¹
4. **ĞŸÑ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ** - Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ´Ğ»Ñ Ğ¼Ğ¾Ğ±Ğ¸Ğ»ÑŒĞ½Ñ‹Ñ… ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²
5. **Ğ Ğ°Ğ·Ğ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²ĞµĞ½Ğ½Ğ¾ÑÑ‚Ğ¸** - Ñ‡ĞµÑ‚ĞºĞ¸Ğµ Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ†Ñ‹ Ğ¼ĞµĞ¶Ğ´Ñƒ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ°Ğ¼Ğ¸

**SOLID Ğ¿Ñ€Ğ¸Ğ½Ñ†Ğ¸Ğ¿Ñ‹:**
- **S** - Single Responsibility Principle
- **O** - Open/Closed Principle
- **L** - Liskov Substitution Principle
- **I** - Interface Segregation Principle
- **D** - Dependency Inversion Principle

---

## 1. Ğ’Ñ‹Ğ±Ğ¾Ñ€ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ½Ğ¾Ğ³Ğ¾ Ğ¿Ğ°Ñ‚Ñ‚ĞµÑ€Ğ½Ğ°

### 1.1 Feature-based Clean Architecture

**ĞĞ±Ğ¾ÑĞ½Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğ°:**
- ĞŸĞ¾Ğ´Ñ…Ğ¾Ğ´Ğ¸Ñ‚ Ğ´Ğ»Ñ React Native Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¹
- Ğ¥Ğ¾Ñ€Ğ¾ÑˆĞ°Ñ Ğ¼Ğ°ÑÑˆÑ‚Ğ°Ğ±Ğ¸Ñ€ÑƒĞµĞ¼Ğ¾ÑÑ‚ÑŒ
- ĞŸÑ€Ğ¾ÑÑ‚Ğ¾Ñ‚Ğ° Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
- Ğ Ğ°Ğ·Ğ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ±Ğ¸Ğ·Ğ½ĞµÑ-Ğ»Ğ¾Ğ³Ğ¸ĞºĞ¸ Ğ¸ UI

**ĞÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ Ğ¿Ñ€Ğ¸Ğ½Ñ†Ğ¸Ğ¿Ñ‹:**
```
External Layer (UI, DB, API)
    â†“
Infrastructure Layer (Repositories, Services)
    â†“
Application Layer (Use Cases, Stores)
    â†“
Domain Layer (Entities, Business Rules)
```

### 1.2 ĞĞ»ÑŒÑ‚ĞµÑ€Ğ½Ğ°Ñ‚Ğ¸Ğ²Ñ‹ Ğ¸ Ğ¾Ğ±Ğ¾ÑĞ½Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¾Ñ‚ĞºĞ°Ğ·Ğ°

**MVP (Model-View-Presenter)**
- âŒ Ğ¡Ğ»Ğ¸ÑˆĞºĞ¾Ğ¼ Ñ‚ĞµÑĞ½Ğ°Ñ ÑĞ²ÑĞ·ÑŒ Ğ¼ĞµĞ¶Ğ´Ñƒ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ°Ğ¼Ğ¸
- âŒ Ğ¡Ğ»Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚Ğ¸ Ñ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸ĞµĞ¼ Presenter

**MVVM (Model-View-ViewModel)**
- âŒ Ğ˜Ğ·Ğ±Ñ‹Ñ‚Ğ¾Ñ‡Ğ½Ğ°Ñ ÑĞ»Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚ÑŒ Ğ´Ğ»Ñ Ğ¼Ğ¾Ğ±Ğ¸Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ
- âŒ Ğ”Ğ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ ÑĞ»Ğ¾Ğ¹ Ğ°Ğ±ÑÑ‚Ñ€Ğ°ĞºÑ†Ğ¸Ğ¸

**MVI (Model-View-Intent)**
- âŒ Ğ¡Ğ»Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚ÑŒ Ğ´Ğ»Ñ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹ Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸
- âŒ Ğ˜Ğ·Ğ±Ñ‹Ñ‚Ğ¾Ñ‡Ğ½Ğ¾ÑÑ‚ÑŒ Ğ´Ğ»Ñ Ğ¸Ğ³Ñ€Ğ¾Ğ²Ğ¾Ğ³Ğ¾ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ

---

## 2. Ğ¡Ğ»Ğ¾ĞµĞ²Ğ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

### 2.1 Domain Layer (Ğ”Ğ¾Ğ¼ĞµĞ½)

**ĞÑ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²ĞµĞ½Ğ½Ğ¾ÑÑ‚ÑŒ:**
- Ğ‘Ğ¸Ğ·Ğ½ĞµÑ-Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»Ğ° Ğ¸Ğ³Ñ€Ñ‹ Ğ¡ÑƒĞ´Ğ¾ĞºÑƒ
- Ğ¡ÑƒÑ‰Ğ½Ğ¾ÑÑ‚Ğ¸ (entities)
- Ğ˜Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹ÑÑ‹ Ğ´Ğ»Ñ Ğ²Ğ½ĞµÑˆĞ½Ğ¸Ñ… Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ĞµĞ¹

```typescript
// domain/entities/Game.ts
export interface GameEntity {
  id: string;
  grid: SudokuGrid;
  originalGrid: SudokuGrid;
  difficulty: DifficultyLevel;
  startTime: Date;
  currentTime: number;
  hintsUsed: number;
  errorsCount: number;
  isCompleted: boolean;
}

// domain/entities/Cell.ts
export interface CellEntity {
  row: number;
  col: number;
  value: CellValue;
  isFixed: boolean;
  isHighlighted: boolean;
  hasError: boolean;
  notes: number[];
}

// domain/entities/Statistics.ts
export interface StatisticsEntity {
  difficulty: DifficultyLevel;
  gamesPlayed: number;
  gamesCompleted: number;
  totalTime: number;
  bestTime: number;
  averageTime: number;
  currentStreak: number;
  longestStreak: number;
}
```

**Ğ‘Ğ¸Ğ·Ğ½ĞµÑ-Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»Ğ°:**
```typescript
// domain/rules/SudokuRules.ts
export class SudokuRules {
  static validateMove(grid: SudokuGrid, row: number, col: number, value: number): boolean {
    return this.isValidInRow(grid, row, value) &&
           this.isValidInColumn(grid, col, value) &&
           this.isValidInBox(grid, row, col, value);
  }

  static isGameComplete(grid: SudokuGrid): boolean {
    // Ğ›Ğ¾Ğ³Ğ¸ĞºĞ° Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¸Ñ Ğ¸Ğ³Ñ€Ñ‹
  }

  static findConflicts(grid: SudokuGrid): CellPosition[] {
    // Ğ›Ğ¾Ğ³Ğ¸ĞºĞ° Ğ¿Ğ¾Ğ¸ÑĞºĞ° ĞºĞ¾Ğ½Ñ„Ğ»Ğ¸ĞºÑ‚Ğ¾Ğ²
  }
}
```

### 2.2 Application Layer (ĞŸÑ€Ğ¸ĞºĞ»Ğ°Ğ´Ğ½Ğ¾Ğ¹ ÑĞ»Ğ¾Ğ¹)

**ĞÑ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²ĞµĞ½Ğ½Ğ¾ÑÑ‚ÑŒ:**
- Use Cases (Ğ²Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚Ñ‹ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ)
- ĞšĞ¾Ğ¾Ñ€Ğ´Ğ¸Ğ½Ğ°Ñ†Ğ¸Ñ Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ´Ğ¾Ğ¼ĞµĞ½Ğ¾Ğ¼ Ğ¸ Ğ¸Ğ½Ñ„Ñ€Ğ°ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ¾Ğ¹
- Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸ĞµĞ¼ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ

```typescript
// application/usecases/StartNewGameUseCase.ts
export class StartNewGameUseCase {
  constructor(
    private gameRepository: IGameRepository,
    private puzzleGenerator: IPuzzleGenerator,
    private statisticsRepository: IStatisticsRepository
  ) {}

  async execute(difficulty: DifficultyLevel): Promise<GameEntity> {
    // 1. Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ½Ğ¾Ğ²Ğ¾Ğ³Ğ¾ Ğ¿Ğ°Ğ·Ğ»Ğ°
    const puzzle = await this.puzzleGenerator.generate(difficulty);

    // 2. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¸Ğ³Ñ€Ğ¾Ğ²Ğ¾Ğ¹ ÑĞµÑÑĞ¸Ğ¸
    const game = new GameEntity({
      id: generateUUID(),
      grid: puzzle.grid,
      originalGrid: puzzle.grid,
      difficulty,
      startTime: new Date(),
      currentTime: 0,
      hintsUsed: 0,
      errorsCount: 0,
      isCompleted: false
    });

    // 3. Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ² Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ¹
    await this.gameRepository.save(game);

    // 4. ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ¸
    await this.statisticsRepository.incrementGamesPlayed(difficulty);

    return game;
  }
}

// application/usecases/MakeMoveUseCase.ts
export class MakeMoveUseCase {
  constructor(
    private gameRepository: IGameRepository,
    private sudokuRules: SudokuRules
  ) {}

  async execute(gameId: string, row: number, col: number, value: number): Promise<MoveResult> {
    const game = await this.gameRepository.findById(gameId);

    // Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ñ…Ğ¾Ğ´Ğ°
    const isValid = this.sudokuRules.validateMove(game.grid, row, col, value);

    if (!isValid) {
      game.errorsCount++;
      await this.gameRepository.save(game);
      return { success: false, hasError: true };
    }

    // ĞŸÑ€Ğ¸Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğµ Ñ…Ğ¾Ğ´Ğ°
    game.grid[row][col] = value;

    // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¸Ñ
    const isComplete = this.sudokuRules.isGameComplete(game.grid);
    if (isComplete) {
      game.isCompleted = true;
      // ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ¸
    }

    await this.gameRepository.save(game);
    return { success: true, isComplete };
  }
}
```

**Zustand Stores:**
```typescript
// application/stores/gameStore.ts
interface GameStore {
  // State
  currentGame: GameEntity | null;
  selectedCell: CellPosition | null;
  showHints: boolean;
  showErrors: boolean;

  // Actions
  startNewGame: (difficulty: DifficultyLevel) => Promise<void>;
  makeMove: (row: number, col: number, value: number) => Promise<void>;
  selectCell: (row: number, col: number) => void;
  useHint: () => Promise<void>;
  pauseGame: () => void;
  resumeGame: () => void;
  saveGame: () => Promise<void>;
}

export const useGameStore = create<GameStore>((set, get) => ({
  currentGame: null,
  selectedCell: null,
  showHints: true,
  showErrors: true,

  startNewGame: async (difficulty) => {
    const startNewGameUseCase = container.resolve(StartNewGameUseCase);
    const game = await startNewGameUseCase.execute(difficulty);
    set({ currentGame: game });
  },

  makeMove: async (row, col, value) => {
    const makeMoveUseCase = container.resolve(MakeMoveUseCase);
    const game = get().currentGame;
    if (!game) return;

    const result = await makeMoveUseCase.execute(game.id, row, col, value);
    // ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ
  }
}));
```

### 2.3 Infrastructure Layer (Ğ˜Ğ½Ñ„Ñ€Ğ°ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ½Ñ‹Ğ¹ ÑĞ»Ğ¾Ğ¹)

**ĞÑ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²ĞµĞ½Ğ½Ğ¾ÑÑ‚ÑŒ:**
- Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹ÑĞ¾Ğ² Ğ¸Ğ· Domain ÑĞ»Ğ¾Ñ
- Ğ Ğ°Ğ±Ğ¾Ñ‚Ğ° Ñ Ğ²Ğ½ĞµÑˆĞ½Ğ¸Ğ¼Ğ¸ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ°Ğ¼Ğ¸ (SQLite, AsyncStorage)
- Ğ¡ĞµÑ‚ĞµĞ²Ñ‹Ğµ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹ (ĞµÑĞ»Ğ¸ ĞµÑÑ‚ÑŒ)

```typescript
// infrastructure/repositories/GameRepository.ts
export class GameRepository implements IGameRepository {
  constructor(private database: SQLiteDatabase) {}

  async save(game: GameEntity): Promise<void> {
    const query = `
      INSERT OR REPLACE INTO games
      (id, grid, original_grid, difficulty, start_time, current_time, hints_used, errors_count, is_completed)
      VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)
    `;

    await this.database.executeSql(query, [
      game.id,
      JSON.stringify(game.grid),
      JSON.stringify(game.originalGrid),
      game.difficulty,
      game.startTime.toISOString(),
      game.currentTime,
      game.hintsUsed,
      game.errorsCount,
      game.isCompleted ? 1 : 0
    ]);
  }

  async findById(id: string): Promise<GameEntity | null> {
    const query = 'SELECT * FROM games WHERE id = ?';
    const result = await this.database.executeSql(query, [id]);

    if (result[0].rows.length === 0) return null;

    const row = result[0].rows.item(0);
    return this.mapRowToEntity(row);
  }

  async findAll(): Promise<GameEntity[]> {
    // Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾Ğ¸ÑĞºĞ° Ğ²ÑĞµÑ… Ğ¸Ğ³Ñ€
  }

  async delete(id: string): Promise<void> {
    // Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ¸Ñ Ğ¸Ğ³Ñ€Ñ‹
  }
}

// infrastructure/services/PuzzleGeneratorService.ts
export class PuzzleGeneratorService implements IPuzzleGenerator {
  async generate(difficulty: DifficultyLevel): Promise<SudokuPuzzle> {
    // 1. Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ğ³Ğ¾ Ñ€ĞµÑˆĞµĞ½Ğ¸Ñ
    const solution = this.generateFullGrid();

    // 2. Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ ÑÑ‡ĞµĞµĞº Ğ¿Ğ¾ ÑƒÑ€Ğ¾Ğ²Ğ½Ñ ÑĞ»Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚Ğ¸
    const puzzle = this.removeCellsByDifficulty(solution, difficulty);

    // 3. Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ ĞµĞ´Ğ¸Ğ½ÑÑ‚Ğ²ĞµĞ½Ğ½Ğ¾ÑÑ‚Ğ¸ Ñ€ĞµÑˆĞµĞ½Ğ¸Ñ
    if (!this.hasUniqueSolution(puzzle)) {
      return this.generate(difficulty); // ĞŸĞ¾Ğ²Ñ‚Ğ¾Ñ€Ğ½Ğ°Ñ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ
    }

    return {
      id: generateUUID(),
      grid: puzzle,
      solution: solution,
      difficulty: difficulty,
      hintsCount: this.countFilledCells(puzzle)
    };
  }

  private generateFullGrid(): SudokuGrid {
    // ĞĞ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ğ¹ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ½Ğ¾Ğ¹ ÑĞµÑ‚ĞºĞ¸
  }

  private removeCellsByDifficulty(grid: SudokuGrid, difficulty: DifficultyLevel): SudokuGrid {
    // Ğ›Ğ¾Ğ³Ğ¸ĞºĞ° ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ¸Ñ ÑÑ‡ĞµĞµĞº Ğ² Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Ğ¾Ñ‚ ÑĞ»Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚Ğ¸
  }
}
```

### 2.4 Presentation Layer (Ğ¡Ğ»Ğ¾Ğ¹ Ğ¿Ñ€ĞµĞ´ÑÑ‚Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ)

**ĞÑ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²ĞµĞ½Ğ½Ğ¾ÑÑ‚ÑŒ:**
- React Native ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹
- Ğ­ĞºÑ€Ğ°Ğ½Ñ‹ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ
- ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒÑĞºĞ¾Ğ³Ğ¾ Ğ²Ğ²Ğ¾Ğ´Ğ°

```typescript
// presentation/screens/GameScreen.tsx
export const GameScreen: React.FC = () => {
  const { currentGame, selectedCell, makeMove, selectCell } = useGameStore();
  const navigation = useNavigation();

  const handleCellPress = useCallback((row: number, col: number) => {
    selectCell(row, col);
  }, [selectCell]);

  const handleNumberInput = useCallback((value: number) => {
    if (!selectedCell) return;
    makeMove(selectedCell.row, selectedCell.col, value);
  }, [selectedCell, makeMove]);

  if (!currentGame) {
    return <LoadingSpinner />;
  }

  return (
    <ScreenContainer>
      <GameHeader game={currentGame} />
      <SudokuBoard
        grid={currentGame.grid}
        selectedCell={selectedCell}
        onCellPress={handleCellPress}
      />
      <NumberPad onNumberPress={handleNumberInput} />
      <GameControls />
    </ScreenContainer>
  );
};

// presentation/components/SudokuBoard.tsx
export const SudokuBoard: React.FC<SudokuBoardProps> = ({
  grid, selectedCell, onCellPress
}) => {
  return (
    <BoardContainer>
      {grid.map((row, rowIndex) =>
        row.map((cell, colIndex) => (
          <SudokuCell
            key={`${rowIndex}-${colIndex}`}
            value={cell}
            row={rowIndex}
            col={colIndex}
            isSelected={
              selectedCell?.row === rowIndex &&
              selectedCell?.col === colIndex
            }
            onPress={() => onCellPress(rowIndex, colIndex)}
          />
        ))
      )}
    </BoardContainer>
  );
};
```

---

## 3. Dependency Injection

### 3.1 IoC Container

```typescript
// infrastructure/di/Container.ts
export class DIContainer {
  private services = new Map<string, any>();
  private singletons = new Map<string, any>();

  register<T>(token: string, factory: () => T, singleton = false): void {
    if (singleton) {
      this.singletons.set(token, factory);
    } else {
      this.services.set(token, factory);
    }
  }

  resolve<T>(token: string): T {
    if (this.singletons.has(token)) {
      const factory = this.singletons.get(token);
      return factory();
    }

    if (this.services.has(token)) {
      const factory = this.services.get(token);
      return factory();
    }

    throw new Error(`Service ${token} not found`);
  }
}

// infrastructure/di/ServiceRegistration.ts
export const setupDI = (container: DIContainer) => {
  // Database
  container.register('SQLiteDatabase', () => SQLite.openDatabase({
    name: 'sudoku.db',
    location: 'default'
  }), true);

  // Repositories
  container.register('IGameRepository', () =>
    new GameRepository(container.resolve('SQLiteDatabase'))
  );

  container.register('IStatisticsRepository', () =>
    new StatisticsRepository(container.resolve('SQLiteDatabase'))
  );

  // Services
  container.register('IPuzzleGenerator', () =>
    new PuzzleGeneratorService()
  );

  // Use Cases
  container.register('StartNewGameUseCase', () =>
    new StartNewGameUseCase(
      container.resolve('IGameRepository'),
      container.resolve('IPuzzleGenerator'),
      container.resolve('IStatisticsRepository')
    )
  );

  container.register('MakeMoveUseCase', () =>
    new MakeMoveUseCase(
      container.resolve('IGameRepository'),
      new SudokuRules()
    )
  );
};
```

---

## 4. Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°

### 4.1 Feature-based Ğ¾Ñ€Ğ³Ğ°Ğ½Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ

```
src/
â”œâ”€â”€ domain/                    # Ğ”Ğ¾Ğ¼ĞµĞ½Ğ½Ñ‹Ğ¹ ÑĞ»Ğ¾Ğ¹
â”‚   â”œâ”€â”€ entities/             # Ğ¡ÑƒÑ‰Ğ½Ğ¾ÑÑ‚Ğ¸
â”‚   â”‚   â”œâ”€â”€ Game.ts
â”‚   â”‚   â”œâ”€â”€ Cell.ts
â”‚   â”‚   â”œâ”€â”€ Statistics.ts
â”‚   â”‚   â””â”€â”€ Settings.ts
â”‚   â”œâ”€â”€ interfaces/           # Ğ˜Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹ÑÑ‹
â”‚   â”‚   â”œâ”€â”€ IGameRepository.ts
â”‚   â”‚   â”œâ”€â”€ IStatisticsRepository.ts
â”‚   â”‚   â”œâ”€â”€ IPuzzleGenerator.ts
â”‚   â”‚   â””â”€â”€ ISettingsStorage.ts
â”‚   â”œâ”€â”€ rules/               # Ğ‘Ğ¸Ğ·Ğ½ĞµÑ-Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»Ğ°
â”‚   â”‚   â”œâ”€â”€ SudokuRules.ts
â”‚   â”‚   â””â”€â”€ DifficultyRules.ts
â”‚   â””â”€â”€ types/               # Ğ”Ğ¾Ğ¼ĞµĞ½Ğ½Ñ‹Ğµ Ñ‚Ğ¸Ğ¿Ñ‹
â”‚       â”œâ”€â”€ GameTypes.ts
â”‚       â””â”€â”€ CommonTypes.ts
â”‚
â”œâ”€â”€ application/              # ĞŸÑ€Ğ¸ĞºĞ»Ğ°Ğ´Ğ½Ğ¾Ğ¹ ÑĞ»Ğ¾Ğ¹
â”‚   â”œâ”€â”€ usecases/            # Ğ’Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚Ñ‹ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
â”‚   â”‚   â”œâ”€â”€ game/
â”‚   â”‚   â”‚   â”œâ”€â”€ StartNewGameUseCase.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ MakeMoveUseCase.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ SaveGameUseCase.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ LoadGameUseCase.ts
â”‚   â”‚   â”‚   â””â”€â”€ UseHintUseCase.ts
â”‚   â”‚   â”œâ”€â”€ statistics/
â”‚   â”‚   â”‚   â”œâ”€â”€ GetStatisticsUseCase.ts
â”‚   â”‚   â”‚   â””â”€â”€ UpdateStatisticsUseCase.ts
â”‚   â”‚   â””â”€â”€ settings/
â”‚   â”‚       â”œâ”€â”€ GetSettingsUseCase.ts
â”‚   â”‚       â””â”€â”€ SaveSettingsUseCase.ts
â”‚   â”œâ”€â”€ stores/              # Zustand stores
â”‚   â”‚   â”œâ”€â”€ gameStore.ts
â”‚   â”‚   â”œâ”€â”€ settingsStore.ts
â”‚   â”‚   â”œâ”€â”€ statisticsStore.ts
â”‚   â”‚   â””â”€â”€ navigationStore.ts
â”‚   â””â”€â”€ services/            # ĞŸÑ€Ğ¸ĞºĞ»Ğ°Ğ´Ğ½Ñ‹Ğµ ÑĞµÑ€Ğ²Ğ¸ÑÑ‹
â”‚       â”œâ”€â”€ GameTimerService.ts
â”‚       â”œâ”€â”€ AchievementService.ts
â”‚       â””â”€â”€ LocalizationService.ts
â”‚
â”œâ”€â”€ infrastructure/           # Ğ˜Ğ½Ñ„Ñ€Ğ°ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ½Ñ‹Ğ¹ ÑĞ»Ğ¾Ğ¹
â”‚   â”œâ”€â”€ repositories/        # Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸ Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸ĞµĞ²
â”‚   â”‚   â”œâ”€â”€ GameRepository.ts
â”‚   â”‚   â”œâ”€â”€ StatisticsRepository.ts
â”‚   â”‚   â””â”€â”€ SettingsRepository.ts
â”‚   â”œâ”€â”€ services/            # Ğ’Ğ½ĞµÑˆĞ½Ğ¸Ğµ ÑĞµÑ€Ğ²Ğ¸ÑÑ‹
â”‚   â”‚   â”œâ”€â”€ PuzzleGeneratorService.ts
â”‚   â”‚   â”œâ”€â”€ DatabaseService.ts
â”‚   â”‚   â”œâ”€â”€ AnalyticsService.ts
â”‚   â”‚   â””â”€â”€ CrashReportingService.ts
â”‚   â”œâ”€â”€ storage/             # Ğ¥Ñ€Ğ°Ğ½Ğ¸Ğ»Ğ¸Ñ‰Ğ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
â”‚   â”‚   â”œâ”€â”€ SQLiteStorage.ts
â”‚   â”‚   â”œâ”€â”€ AsyncStorage.ts
â”‚   â”‚   â””â”€â”€ MMKVStorage.ts
â”‚   â”œâ”€â”€ api/                 # API ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ñ‹ (ĞµÑĞ»Ğ¸ Ğ½ÑƒĞ¶Ğ½Ğ¾)
â”‚   â”‚   â””â”€â”€ SudokuApiClient.ts
â”‚   â””â”€â”€ di/                  # Dependency Injection
â”‚       â”œâ”€â”€ Container.ts
â”‚       â””â”€â”€ ServiceRegistration.ts
â”‚
â”œâ”€â”€ presentation/             # Ğ¡Ğ»Ğ¾Ğ¹ Ğ¿Ñ€ĞµĞ´ÑÑ‚Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ
â”‚   â”œâ”€â”€ screens/             # Ğ­ĞºÑ€Ğ°Ğ½Ñ‹
â”‚   â”‚   â”œâ”€â”€ Home/
â”‚   â”‚   â”‚   â”œâ”€â”€ HomeScreen.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ DifficultySelectionScreen.tsx
â”‚   â”‚   â”‚   â””â”€â”€ SavedGamesScreen.tsx
â”‚   â”‚   â”œâ”€â”€ Game/
â”‚   â”‚   â”‚   â”œâ”€â”€ GameScreen.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ PauseScreen.tsx
â”‚   â”‚   â”‚   â””â”€â”€ VictoryScreen.tsx
â”‚   â”‚   â”œâ”€â”€ Settings/
â”‚   â”‚   â”‚   â”œâ”€â”€ SettingsScreen.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ ThemeSelectionScreen.tsx
â”‚   â”‚   â”‚   â””â”€â”€ AboutScreen.tsx
â”‚   â”‚   â””â”€â”€ Statistics/
â”‚   â”‚       â”œâ”€â”€ StatisticsScreen.tsx
â”‚   â”‚       â””â”€â”€ AchievementsScreen.tsx
â”‚   â”œâ”€â”€ components/          # React ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹
â”‚   â”‚   â”œâ”€â”€ ui/             # Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğµ UI ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹
â”‚   â”‚   â”‚   â”œâ”€â”€ Button.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Input.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Modal.tsx
â”‚   â”‚   â”‚   â””â”€â”€ LoadingSpinner.tsx
â”‚   â”‚   â”œâ”€â”€ game/           # Ğ˜Ğ³Ñ€Ğ¾Ğ²Ñ‹Ğµ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹
â”‚   â”‚   â”‚   â”œâ”€â”€ SudokuBoard.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ SudokuCell.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ NumberPad.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ GameHeader.tsx
â”‚   â”‚   â”‚   â””â”€â”€ GameControls.tsx
â”‚   â”‚   â””â”€â”€ common/         # ĞĞ±Ñ‰Ğ¸Ğµ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹
â”‚   â”‚       â”œâ”€â”€ ScreenContainer.tsx
â”‚   â”‚       â”œâ”€â”€ Header.tsx
â”‚   â”‚       â””â”€â”€ ErrorBoundary.tsx
â”‚   â”œâ”€â”€ navigation/          # ĞĞ°Ğ²Ğ¸Ğ³Ğ°Ñ†Ğ¸Ñ
â”‚   â”‚   â”œâ”€â”€ AppNavigator.tsx
â”‚   â”‚   â”œâ”€â”€ StackNavigators.tsx
â”‚   â”‚   â””â”€â”€ TabNavigators.tsx
â”‚   â”œâ”€â”€ hooks/               # Custom hooks
â”‚   â”‚   â”œâ”€â”€ useGame.ts
â”‚   â”‚   â”œâ”€â”€ useTimer.ts
â”‚   â”‚   â”œâ”€â”€ useAnalytics.ts
â”‚   â”‚   â””â”€â”€ useKeyboard.ts
â”‚   â””â”€â”€ styles/              # Ğ¡Ñ‚Ğ¸Ğ»Ğ¸
â”‚       â”œâ”€â”€ themes.ts
â”‚       â”œâ”€â”€ colors.ts
â”‚       â”œâ”€â”€ typography.ts
â”‚       â””â”€â”€ dimensions.ts
â”‚
â”œâ”€â”€ shared/                   # ĞĞ±Ñ‰Ğ¸Ğ¹ ĞºĞ¾Ğ´
â”‚   â”œâ”€â”€ constants/           # ĞšĞ¾Ğ½ÑÑ‚Ğ°Ğ½Ñ‚Ñ‹
â”‚   â”‚   â”œâ”€â”€ GameConstants.ts
â”‚   â”‚   â”œâ”€â”€ StorageKeys.ts
â”‚   â”‚   â””â”€â”€ AnalyticsEvents.ts
â”‚   â”œâ”€â”€ utils/               # Ğ£Ñ‚Ğ¸Ğ»Ğ¸Ñ‚Ñ‹
â”‚   â”‚   â”œâ”€â”€ gameLogic.ts
â”‚   â”‚   â”œâ”€â”€ dateUtils.ts
â”‚   â”‚   â”œâ”€â”€ validation.ts
â”‚   â”‚   â””â”€â”€ formatting.ts
â”‚   â”œâ”€â”€ types/               # TypeScript Ñ‚Ğ¸Ğ¿Ñ‹
â”‚   â”‚   â”œâ”€â”€ navigation.ts
â”‚   â”‚   â”œâ”€â”€ api.ts
â”‚   â”‚   â””â”€â”€ storage.ts
â”‚   â””â”€â”€ localization/        # Ğ›Ğ¾ĞºĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ
â”‚       â”œâ”€â”€ i18n.ts
â”‚       â”œâ”€â”€ locales/
â”‚       â”‚   â”œâ”€â”€ en.json
â”‚       â”‚   â””â”€â”€ ru.json
â”‚       â””â”€â”€ types.ts
â”‚
â””â”€â”€ assets/                   # Ğ ĞµÑÑƒÑ€ÑÑ‹
    â”œâ”€â”€ images/
    â”œâ”€â”€ icons/
    â”œâ”€â”€ fonts/
    â””â”€â”€ sounds/
```

---

## 5. ĞŸĞ°Ñ‚Ñ‚ĞµÑ€Ğ½Ñ‹ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸ĞµĞ¼

### 5.1 Zustand Store Architecture

```typescript
// application/stores/types.ts
export interface AppState {
  game: GameState;
  settings: SettingsState;
  statistics: StatisticsState;
  ui: UIState;
}

export interface GameState {
  currentGame: GameEntity | null;
  selectedCell: CellPosition | null;
  gameHistory: GameMove[];
  gameTimer: number;
  isPaused: boolean;
  showHints: boolean;
  showErrors: boolean;
}

// application/stores/createGameSlice.ts
export const createGameSlice: StateCreator<AppState, [], [], GameState> = (set, get) => ({
  currentGame: null,
  selectedCell: null,
  gameHistory: [],
  gameTimer: 0,
  isPaused: false,
  showHints: true,
  showErrors: true,

  // Actions
  startNewGame: async (difficulty: DifficultyLevel) => {
    const useCase = container.resolve(StartNewGameUseCase);
    const game = await useCase.execute(difficulty);

    set((state) => ({
      ...state,
      game: {
        ...state.game,
        currentGame: game,
        gameHistory: [],
        gameTimer: 0,
        isPaused: false
      }
    }));
  },

  makeMove: async (row: number, col: number, value: number) => {
    const useCase = container.resolve(MakeMoveUseCase);
    const { currentGame } = get().game;

    if (!currentGame) return;

    const result = await useCase.execute(currentGame.id, row, col, value);

    if (result.success) {
      set((state) => ({
        ...state,
        game: {
          ...state.game,
          currentGame: result.game,
          gameHistory: [...state.game.gameHistory, {
            row, col, value, timestamp: new Date()
          }]
        }
      }));
    }
  }
});

// application/stores/useAppStore.ts
export const useAppStore = create<AppState>()(
  devtools(
    persist(
      (...args) => ({
        game: createGameSlice(...args),
        settings: createSettingsSlice(...args),
        statistics: createStatisticsSlice(...args),
        ui: createUISlice(...args)
      }),
      {
        name: 'sudoku-app-store',
        partialize: (state) => ({
          settings: state.settings,
          statistics: state.statistics
        })
      }
    ),
    { name: 'sudoku-store' }
  )
);
```

### 5.2 Error Handling Pattern

```typescript
// shared/types/Result.ts
export type Result<T, E = Error> = {
  success: true;
  data: T;
} | {
  success: false;
  error: E;
};

// application/usecases/base/BaseUseCase.ts
export abstract class BaseUseCase<TRequest, TResponse> {
  abstract execute(request: TRequest): Promise<Result<TResponse>>;

  protected handleError(error: unknown): Result<never> {
    if (error instanceof DomainError) {
      return { success: false, error };
    }

    return { success: false, error: new UnknownError('An unexpected error occurred') };
  }
}

// domain/errors/DomainErrors.ts
export abstract class DomainError extends Error {
  abstract readonly code: string;
}

export class InvalidMoveError extends DomainError {
  readonly code = 'INVALID_MOVE';
  constructor(message: string) {
    super(message);
  }
}

export class GameNotFoundError extends DomainError {
  readonly code = 'GAME_NOT_FOUND';
  constructor(gameId: string) {
    super(`Game with id ${gameId} not found`);
  }
}
```

---

## 6. Ğ’Ğ·Ğ°Ğ¸Ğ¼Ğ¾Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğµ Ğ¼ĞµĞ¶Ğ´Ñƒ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ°Ğ¼Ğ¸

### 6.1 Ğ”Ğ¸Ğ°Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ° Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ñ‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PRESENTATION LAYER                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Screens     â”‚  Components   â”‚  Navigation  â”‚  Hooks     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚GameScreenâ”‚ â”‚  â”‚SudokuCellâ”‚  â”‚  â”‚Navigatorâ”‚ â”‚ â”‚useGame â”‚â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   APPLICATION LAYER                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Use Cases    â”‚    Stores     â”‚    Services           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚StartNewGameâ”‚ â”‚  â”‚GameStoreâ”‚  â”‚  â”‚LocalizationSvc â”‚   â”‚
â”‚  â”‚MakeMove   â”‚ â”‚  â”‚Settings â”‚  â”‚  â”‚TimerService    â”‚   â”‚
â”‚  â”‚SaveGame   â”‚ â”‚  â”‚Statisticsâ”‚  â”‚  â”‚AnalyticsServiceâ”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     DOMAIN LAYER                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Entities     â”‚    Rules      â”‚    Interfaces          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚Game     â”‚   â”‚  â”‚SudokuRulesâ”‚  â”‚  â”‚IGameRepository â”‚   â”‚
â”‚  â”‚Cell     â”‚   â”‚  â”‚Difficulty â”‚  â”‚  â”‚IPuzzleGeneratorâ”‚   â”‚
â”‚  â”‚Statisticsâ”‚   â”‚  â”‚Validation â”‚  â”‚  â”‚ISettingsStorageâ”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 INFRASTRUCTURE LAYER                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Repositories   â”‚   Services    â”‚   Storage              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚GameRepo    â”‚ â”‚ â”‚PuzzleGen  â”‚ â”‚ â”‚SQLite   â”‚AsyncStoreâ”‚ â”‚
â”‚ â”‚StatsRepo   â”‚ â”‚ â”‚Analytics  â”‚ â”‚ â”‚MMKV     â”‚FileSystemâ”‚ â”‚
â”‚ â”‚SettingsRepoâ”‚ â”‚ â”‚CrashRep   â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 Data Flow

```typescript
// ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…: Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ğ´ĞµĞ»Ğ°ĞµÑ‚ Ñ…Ğ¾Ğ´
[User Input] â†’ [SudokuCell.onPress]
    â†“
[GameScreen.handleCellPress] â†’ [gameStore.selectCell]
    â†“
[User Input] â†’ [NumberPad.onNumberPress]
    â†“
[GameScreen.handleNumberInput] â†’ [gameStore.makeMove]
    â†“
[MakeMoveUseCase.execute] â†’ [SudokuRules.validateMove]
    â†“
[GameRepository.save] â†’ [SQLite Database]
    â†“
[Store State Update] â†’ [Component Re-render]
```

---

## 7. Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ñ‹

### 7.1 Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ğ¾ ÑĞ»Ğ¾ÑĞ¼

```typescript
// __tests__/domain/SudokuRules.test.ts
describe('SudokuRules', () => {
  test('should validate correct move', () => {
    const grid = generateEmptyGrid();
    const isValid = SudokuRules.validateMove(grid, 0, 0, 5);
    expect(isValid).toBe(true);
  });

  test('should reject duplicate in row', () => {
    const grid = generateGridWithDuplicateInRow();
    const isValid = SudokuRules.validateMove(grid, 0, 1, 5);
    expect(isValid).toBe(false);
  });
});

// __tests__/application/StartNewGameUseCase.test.ts
describe('StartNewGameUseCase', () => {
  let useCase: StartNewGameUseCase;
  let mockGameRepo: jest.Mocked<IGameRepository>;
  let mockPuzzleGen: jest.Mocked<IPuzzleGenerator>;

  beforeEach(() => {
    mockGameRepo = createMockGameRepository();
    mockPuzzleGen = createMockPuzzleGenerator();
    useCase = new StartNewGameUseCase(mockGameRepo, mockPuzzleGen, mockStatsRepo);
  });

  test('should create new game with generated puzzle', async () => {
    const mockPuzzle = createMockPuzzle('easy');
    mockPuzzleGen.generate.mockResolvedValue(mockPuzzle);

    const result = await useCase.execute('easy');

    expect(result.success).toBe(true);
    expect(mockGameRepo.save).toHaveBeenCalledWith(
      expect.objectContaining({
        difficulty: 'easy',
        grid: mockPuzzle.grid
      })
    );
  });
});

// __tests__/infrastructure/GameRepository.test.ts
describe('GameRepository', () => {
  let repository: GameRepository;
  let mockDatabase: jest.Mocked<SQLiteDatabase>;

  beforeEach(() => {
    mockDatabase = createMockSQLiteDatabase();
    repository = new GameRepository(mockDatabase);
  });

  test('should save game to database', async () => {
    const game = createMockGame();
    await repository.save(game);

    expect(mockDatabase.executeSql).toHaveBeenCalledWith(
      expect.stringContaining('INSERT OR REPLACE INTO games'),
      expect.arrayContaining([game.id, expect.any(String)])
    );
  });
});

// __tests__/presentation/GameScreen.test.tsx
describe('GameScreen', () => {
  test('should render sudoku board', () => {
    const mockGame = createMockGame();
    const mockStore = createMockStore({ currentGame: mockGame });

    const { getByTestId } = render(
      <GameScreen />,
      { wrapper: createTestWrapper(mockStore) }
    );

    expect(getByTestId('sudoku-board')).toBeTruthy();
  });

  test('should handle cell press', () => {
    const mockGame = createMockGame();
    const mockSelectCell = jest.fn();
    const mockStore = createMockStore({
      currentGame: mockGame,
      selectCell: mockSelectCell
    });

    const { getByTestId } = render(
      <GameScreen />,
      { wrapper: createTestWrapper(mockStore) }
    );

    fireEvent.press(getByTestId('cell-0-0'));
    expect(mockSelectCell).toHaveBeenCalledWith(0, 0);
  });
});
```

### 7.2 Integration Tests

```typescript
// __tests__/integration/GameFlow.test.ts
describe('Game Flow Integration', () => {
  let container: DIContainer;

  beforeEach(async () => {
    container = new DIContainer();
    await setupTestDI(container);
  });

  test('should complete full game flow', async () => {
    // 1. Start new game
    const startGameUseCase = container.resolve(StartNewGameUseCase);
    const game = await startGameUseCase.execute('easy');

    // 2. Make valid moves
    const makeMoveUseCase = container.resolve(MakeMoveUseCase);
    const result = await makeMoveUseCase.execute(game.id, 0, 0, 5);

    // 3. Verify state
    expect(result.success).toBe(true);

    // 4. Check game saved
    const gameRepo = container.resolve('IGameRepository');
    const savedGame = await gameRepo.findById(game.id);
    expect(savedGame?.grid[0][0]).toBe(5);
  });
});
```

---

## âœ… ĞšÑ€Ğ¸Ñ‚ĞµÑ€Ğ¸Ğ¸ Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ñ‹

**ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° ÑÑ‡Ğ¸Ñ‚Ğ°ĞµÑ‚ÑÑ Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ¾Ğ¹, ĞºĞ¾Ğ³Ğ´Ğ°:**
1. âœ… ĞĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ñ‹ Ğ²ÑĞµ ÑĞ»Ğ¾Ğ¸ Ğ¸ Ğ¸Ñ… Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²ĞµĞ½Ğ½Ğ¾ÑÑ‚Ğ¸
2. âœ… Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ° ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°
3. âœ… ĞĞ°ÑÑ‚Ñ€Ğ¾ĞµĞ½ Dependency Injection
4. âœ… ĞĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ñ‹ Ğ¿Ğ°Ñ‚Ñ‚ĞµÑ€Ğ½Ñ‹ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸ĞµĞ¼
5. âœ… Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ñ‹ Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹ÑÑ‹ Ğ´Ğ»Ñ Ğ²ÑĞµÑ… Ğ²Ğ½ĞµÑˆĞ½Ğ¸Ñ… Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ĞµĞ¹
6. âœ… ĞĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ñ‹ ÑÑ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸Ğ¸ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
7. âœ… Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ñ‹ Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
8. âœ… Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ñ‹ Ğ´Ğ¸Ğ°Ğ³Ñ€Ğ°Ğ¼Ğ¼Ñ‹ Ğ²Ğ·Ğ°Ğ¸Ğ¼Ğ¾Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ

---

## ğŸš€ Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğµ ÑˆĞ°Ğ³Ğ¸

ĞŸĞ¾ÑĞ»Ğµ ÑƒÑ‚Ğ²ĞµÑ€Ğ¶Ğ´ĞµĞ½Ğ¸Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ñ‹:
1. **2.1.4** - Ğ’Ñ‹Ğ±Ğ¾Ñ€ Ğ±Ğ°Ğ·Ñ‹ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ´Ğ»Ñ Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ñ
2. **2.1.5** - Ğ’Ñ‹Ğ±Ğ¾Ñ€ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ğ¾Ğ² Ğ´Ğ»Ñ Ğ°Ğ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ¸
3. **2.2.1** - Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ´Ğ¸Ğ°Ğ³Ñ€Ğ°Ğ¼Ğ¼Ñ‹ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ñ‹
4. **3.1.1** - ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ° Ğ¸ ÑÑ€ĞµĞ´Ñ‹ Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸

---

**ĞŸĞ¾ÑĞ»ĞµĞ´Ğ½ĞµĞµ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ**: 19 ÑĞµĞ½Ñ‚ÑĞ±Ñ€Ñ 2025
**Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ**: âœ… Ğ—Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¾