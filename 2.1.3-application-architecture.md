# 2.1.3 –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

## –°—Ç–∞—Ç—É—Å: üîÑ –í —Ä–∞–±–æ—Ç–µ
**–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞**: 19 —Å–µ–Ω—Ç—è–±—Ä—è 2025
**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π**: voleum

---

## –û–±—â–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### üéØ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ü–µ–ª–∏

**–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã:**
1. **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** - –ª–µ–≥–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
2. **–¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å** - –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å unit –∏ integration —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
3. **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç—å** - –ø—Ä–æ—Å—Ç–æ—Ç–∞ –≤–Ω–µ—Å–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
4. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
5. **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏** - —á–µ—Ç–∫–∏–µ –≥—Ä–∞–Ω–∏—Ü—ã –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏

**SOLID –ø—Ä–∏–Ω—Ü–∏–ø—ã:**
- **S** - Single Responsibility Principle
- **O** - Open/Closed Principle
- **L** - Liskov Substitution Principle
- **I** - Interface Segregation Principle
- **D** - Dependency Inversion Principle

---

## 1. –í—ã–±–æ—Ä –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–≥–æ –ø–∞—Ç—Ç–µ—Ä–Ω–∞

### 1.1 Feature-based Clean Architecture

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –≤—ã–±–æ—Ä–∞:**
- –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è React Native –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
- –•–æ—Ä–æ—à–∞—è –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å
- –ü—Ä–æ—Å—Ç–æ—Ç–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ –∏ UI

**–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã:**
```
External Layer (UI, DB, API)
    ‚Üì
Infrastructure Layer (Repositories, Services)
    ‚Üì
Application Layer (Use Cases, Stores)
    ‚Üì
Domain Layer (Entities, Business Rules)
```

### 1.2 –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã –∏ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –æ—Ç–∫–∞–∑–∞

**MVP (Model-View-Presenter)**
- ‚ùå –°–ª–∏—à–∫–æ–º —Ç–µ—Å–Ω–∞—è —Å–≤—è–∑—å –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏
- ‚ùå –°–ª–æ–∂–Ω–æ—Å—Ç–∏ —Å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º Presenter

**MVVM (Model-View-ViewModel)**
- ‚ùå –ò–∑–±—ã—Ç–æ—á–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å –¥–ª—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- ‚ùå –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Å–ª–æ–π –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏

**MVI (Model-View-Intent)**
- ‚ùå –°–ª–æ–∂–Ω–æ—Å—Ç—å –¥–ª—è –∫–æ–º–∞–Ω–¥—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- ‚ùå –ò–∑–±—ã—Ç–æ—á–Ω–æ—Å—Ç—å –¥–ª—è –∏–≥—Ä–æ–≤–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

---

## 2. –°–ª–æ–µ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### 2.1 Domain Layer (–î–æ–º–µ–Ω)

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –ë–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞ –∏–≥—Ä—ã –°—É–¥–æ–∫—É
- –°—É—â–Ω–æ—Å—Ç–∏ (entities)
- –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```typescript
// domain/entities/Game.ts
export interface GameEntity {
  id: string;
  grid: SudokuGrid;
  originalGrid: SudokuGrid;
  difficulty: DifficultyLevel;
  startTime: Date;
  currentTime: number;
  hintsUsed: number;
  errorsCount: number;
  isCompleted: boolean;
}

// domain/entities/Cell.ts
export interface CellEntity {
  row: number;
  col: number;
  value: CellValue;
  isFixed: boolean;
  isHighlighted: boolean;
  hasError: boolean;
  notes: number[];
}

// domain/entities/Statistics.ts
export interface StatisticsEntity {
  difficulty: DifficultyLevel;
  gamesPlayed: number;
  gamesCompleted: number;
  totalTime: number;
  bestTime: number;
  averageTime: number;
  currentStreak: number;
  longestStreak: number;
}
```

**–ë–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞:**
```typescript
// domain/rules/SudokuRules.ts
export class SudokuRules {
  static validateMove(grid: SudokuGrid, row: number, col: number, value: number): boolean {
    return this.isValidInRow(grid, row, value) &&
           this.isValidInColumn(grid, col, value) &&
           this.isValidInBox(grid, row, col, value);
  }

  static isGameComplete(grid: SudokuGrid): boolean {
    // –õ–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏–≥—Ä—ã
  }

  static findConflicts(grid: SudokuGrid): CellPosition[] {
    // –õ–æ–≥–∏–∫–∞ –ø–æ–∏—Å–∫–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
  }
}
```

### 2.2 Application Layer (–ü—Ä–∏–∫–ª–∞–¥–Ω–æ–π —Å–ª–æ–π)

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- Use Cases (–≤–∞—Ä–∏–∞–Ω—Ç—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)
- –ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –º–µ–∂–¥—É –¥–æ–º–µ–Ω–æ–º –∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```typescript
// application/usecases/StartNewGameUseCase.ts
export class StartNewGameUseCase {
  constructor(
    private gameRepository: IGameRepository,
    private puzzleGenerator: IPuzzleGenerator,
    private statisticsRepository: IStatisticsRepository
  ) {}

  async execute(difficulty: DifficultyLevel): Promise<GameEntity> {
    // 1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–∞–∑–ª–∞
    const puzzle = await this.puzzleGenerator.generate(difficulty);

    // 2. –°–æ–∑–¥–∞–Ω–∏–µ –∏–≥—Ä–æ–≤–æ–π —Å–µ—Å—Å–∏–∏
    const game = new GameEntity({
      id: generateUUID(),
      grid: puzzle.grid,
      originalGrid: puzzle.grid,
      difficulty,
      startTime: new Date(),
      currentTime: 0,
      hintsUsed: 0,
      errorsCount: 0,
      isCompleted: false
    });

    // 3. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
    await this.gameRepository.save(game);

    // 4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
    await this.statisticsRepository.incrementGamesPlayed(difficulty);

    return game;
  }
}

// application/usecases/MakeMoveUseCase.ts
export class MakeMoveUseCase {
  constructor(
    private gameRepository: IGameRepository,
    private sudokuRules: SudokuRules
  ) {}

  async execute(gameId: string, row: number, col: number, value: number): Promise<MoveResult> {
    const game = await this.gameRepository.findById(gameId);

    // –í–∞–ª–∏–¥–∞—Ü–∏—è —Ö–æ–¥–∞
    const isValid = this.sudokuRules.validateMove(game.grid, row, col, value);

    if (!isValid) {
      game.errorsCount++;
      await this.gameRepository.save(game);
      return { success: false, hasError: true };
    }

    // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ö–æ–¥–∞
    game.grid[row][col] = value;

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
    const isComplete = this.sudokuRules.isGameComplete(game.grid);
    if (isComplete) {
      game.isCompleted = true;
      // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
    }

    await this.gameRepository.save(game);
    return { success: true, isComplete };
  }
}
```

**Zustand Stores:**
```typescript
// application/stores/gameStore.ts
interface GameStore {
  // State
  currentGame: GameEntity | null;
  selectedCell: CellPosition | null;
  showHints: boolean;
  showErrors: boolean;

  // Actions
  startNewGame: (difficulty: DifficultyLevel) => Promise<void>;
  makeMove: (row: number, col: number, value: number) => Promise<void>;
  selectCell: (row: number, col: number) => void;
  useHint: () => Promise<void>;
  pauseGame: () => void;
  resumeGame: () => void;
  saveGame: () => Promise<void>;
}

export const useGameStore = create<GameStore>((set, get) => ({
  currentGame: null,
  selectedCell: null,
  showHints: true,
  showErrors: true,

  startNewGame: async (difficulty) => {
    const startNewGameUseCase = container.resolve(StartNewGameUseCase);
    const game = await startNewGameUseCase.execute(difficulty);
    set({ currentGame: game });
  },

  makeMove: async (row, col, value) => {
    const makeMoveUseCase = container.resolve(MakeMoveUseCase);
    const game = get().currentGame;
    if (!game) return;

    const result = await makeMoveUseCase.execute(game.id, row, col, value);
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
  }
}));
```

### 2.3 Infrastructure Layer (–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–π —Å–ª–æ–π)

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ –∏–∑ Domain —Å–ª–æ—è
- –†–∞–±–æ—Ç–∞ —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏ (SQLite, AsyncStorage)
- –°–µ—Ç–µ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã (–µ—Å–ª–∏ –µ—Å—Ç—å)

```typescript
// infrastructure/repositories/GameRepository.ts
export class GameRepository implements IGameRepository {
  constructor(private database: SQLiteDatabase) {}

  async save(game: GameEntity): Promise<void> {
    const query = `
      INSERT OR REPLACE INTO games
      (id, grid, original_grid, difficulty, start_time, current_time, hints_used, errors_count, is_completed)
      VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)
    `;

    await this.database.executeSql(query, [
      game.id,
      JSON.stringify(game.grid),
      JSON.stringify(game.originalGrid),
      game.difficulty,
      game.startTime.toISOString(),
      game.currentTime,
      game.hintsUsed,
      game.errorsCount,
      game.isCompleted ? 1 : 0
    ]);
  }

  async findById(id: string): Promise<GameEntity | null> {
    const query = 'SELECT * FROM games WHERE id = ?';
    const result = await this.database.executeSql(query, [id]);

    if (result[0].rows.length === 0) return null;

    const row = result[0].rows.item(0);
    return this.mapRowToEntity(row);
  }

  async findAll(): Promise<GameEntity[]> {
    // –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–∏—Å–∫–∞ –≤—Å–µ—Ö –∏–≥—Ä
  }

  async delete(id: string): Promise<void> {
    // –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —É–¥–∞–ª–µ–Ω–∏—è –∏–≥—Ä—ã
  }
}

// infrastructure/services/PuzzleGeneratorService.ts
export class PuzzleGeneratorService implements IPuzzleGenerator {
  async generate(difficulty: DifficultyLevel): Promise<SudokuPuzzle> {
    // 1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ–ª–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è
    const solution = this.generateFullGrid();

    // 2. –£–¥–∞–ª–µ–Ω–∏–µ —è—á–µ–µ–∫ –ø–æ —É—Ä–æ–≤–Ω—é —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
    const puzzle = this.removeCellsByDifficulty(solution, difficulty);

    // 3. –í–∞–ª–∏–¥–∞—Ü–∏—è –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ—à–µ–Ω–∏—è
    if (!this.hasUniqueSolution(puzzle)) {
      return this.generate(difficulty); // –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è
    }

    return {
      id: generateUUID(),
      grid: puzzle,
      solution: solution,
      difficulty: difficulty,
      hintsCount: this.countFilledCells(puzzle)
    };
  }

  private generateFullGrid(): SudokuGrid {
    // –ê–ª–≥–æ—Ä–∏—Ç–º –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–æ–ª–Ω–æ–π –≤–∞–ª–∏–¥–Ω–æ–π —Å–µ—Ç–∫–∏
  }

  private removeCellsByDifficulty(grid: SudokuGrid, difficulty: DifficultyLevel): SudokuGrid {
    // –õ–æ–≥–∏–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —è—á–µ–µ–∫ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
  }
}
```

### 2.4 Presentation Layer (–°–ª–æ–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è)

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- React Native –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- –≠–∫—Ä–∞–Ω—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞

```typescript
// presentation/screens/GameScreen.tsx
export const GameScreen: React.FC = () => {
  const { currentGame, selectedCell, makeMove, selectCell } = useGameStore();
  const navigation = useNavigation();

  const handleCellPress = useCallback((row: number, col: number) => {
    selectCell(row, col);
  }, [selectCell]);

  const handleNumberInput = useCallback((value: number) => {
    if (!selectedCell) return;
    makeMove(selectedCell.row, selectedCell.col, value);
  }, [selectedCell, makeMove]);

  if (!currentGame) {
    return <LoadingSpinner />;
  }

  return (
    <ScreenContainer>
      <GameHeader game={currentGame} />
      <SudokuBoard
        grid={currentGame.grid}
        selectedCell={selectedCell}
        onCellPress={handleCellPress}
      />
      <NumberPad onNumberPress={handleNumberInput} />
      <GameControls />
    </ScreenContainer>
  );
};

// presentation/components/SudokuBoard.tsx
export const SudokuBoard: React.FC<SudokuBoardProps> = ({
  grid, selectedCell, onCellPress
}) => {
  return (
    <BoardContainer>
      {grid.map((row, rowIndex) =>
        row.map((cell, colIndex) => (
          <SudokuCell
            key={`${rowIndex}-${colIndex}`}
            value={cell}
            row={rowIndex}
            col={colIndex}
            isSelected={
              selectedCell?.row === rowIndex &&
              selectedCell?.col === colIndex
            }
            onPress={() => onCellPress(rowIndex, colIndex)}
          />
        ))
      )}
    </BoardContainer>
  );
};
```

---

## 3. Dependency Injection

### 3.1 IoC Container

```typescript
// infrastructure/di/Container.ts
export class DIContainer {
  private services = new Map<string, any>();
  private singletons = new Map<string, any>();

  register<T>(token: string, factory: () => T, singleton = false): void {
    if (singleton) {
      this.singletons.set(token, factory);
    } else {
      this.services.set(token, factory);
    }
  }

  resolve<T>(token: string): T {
    if (this.singletons.has(token)) {
      const factory = this.singletons.get(token);
      return factory();
    }

    if (this.services.has(token)) {
      const factory = this.services.get(token);
      return factory();
    }

    throw new Error(`Service ${token} not found`);
  }
}

// infrastructure/di/ServiceRegistration.ts
export const setupDI = (container: DIContainer) => {
  // Database
  container.register('SQLiteDatabase', () => SQLite.openDatabase({
    name: 'sudoku.db',
    location: 'default'
  }), true);

  // Repositories
  container.register('IGameRepository', () =>
    new GameRepository(container.resolve('SQLiteDatabase'))
  );

  container.register('IStatisticsRepository', () =>
    new StatisticsRepository(container.resolve('SQLiteDatabase'))
  );

  // Services
  container.register('IPuzzleGenerator', () =>
    new PuzzleGeneratorService()
  );

  // Use Cases
  container.register('StartNewGameUseCase', () =>
    new StartNewGameUseCase(
      container.resolve('IGameRepository'),
      container.resolve('IPuzzleGenerator'),
      container.resolve('IStatisticsRepository')
    )
  );

  container.register('MakeMoveUseCase', () =>
    new MakeMoveUseCase(
      container.resolve('IGameRepository'),
      new SudokuRules()
    )
  );
};
```

---

## 4. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

### 4.1 Feature-based –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è

```
src/
‚îú‚îÄ‚îÄ domain/                    # –î–æ–º–µ–Ω–Ω—ã–π —Å–ª–æ–π
‚îÇ   ‚îú‚îÄ‚îÄ entities/             # –°—É—â–Ω–æ—Å—Ç–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Game.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Cell.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Statistics.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Settings.ts
‚îÇ   ‚îú‚îÄ‚îÄ interfaces/           # –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ IGameRepository.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ IStatisticsRepository.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ IPuzzleGenerator.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ISettingsStorage.ts
‚îÇ   ‚îú‚îÄ‚îÄ rules/               # –ë–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ SudokuRules.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ DifficultyRules.ts
‚îÇ   ‚îî‚îÄ‚îÄ types/               # –î–æ–º–µ–Ω–Ω—ã–µ —Ç–∏–ø—ã
‚îÇ       ‚îú‚îÄ‚îÄ GameTypes.ts
‚îÇ       ‚îî‚îÄ‚îÄ CommonTypes.ts
‚îÇ
‚îú‚îÄ‚îÄ application/              # –ü—Ä–∏–∫–ª–∞–¥–Ω–æ–π —Å–ª–æ–π
‚îÇ   ‚îú‚îÄ‚îÄ usecases/            # –í–∞—Ä–∏–∞–Ω—Ç—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ game/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ StartNewGameUseCase.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ MakeMoveUseCase.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ SaveGameUseCase.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ LoadGameUseCase.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ UseHintUseCase.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ statistics/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ GetStatisticsUseCase.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ UpdateStatisticsUseCase.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ settings/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ GetSettingsUseCase.ts
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ SaveSettingsUseCase.ts
‚îÇ   ‚îú‚îÄ‚îÄ stores/              # Zustand stores
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ gameStore.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ settingsStore.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ statisticsStore.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ navigationStore.ts
‚îÇ   ‚îî‚îÄ‚îÄ services/            # –ü—Ä–∏–∫–ª–∞–¥–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
‚îÇ       ‚îú‚îÄ‚îÄ GameTimerService.ts
‚îÇ       ‚îú‚îÄ‚îÄ AchievementService.ts
‚îÇ       ‚îî‚îÄ‚îÄ LocalizationService.ts
‚îÇ
‚îú‚îÄ‚îÄ infrastructure/           # –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–π —Å–ª–æ–π
‚îÇ   ‚îú‚îÄ‚îÄ repositories/        # –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ GameRepository.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ StatisticsRepository.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ SettingsRepository.ts
‚îÇ   ‚îú‚îÄ‚îÄ services/            # –í–Ω–µ—à–Ω–∏–µ —Å–µ—Ä–≤–∏—Å—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ PuzzleGeneratorService.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ DatabaseService.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AnalyticsService.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ CrashReportingService.ts
‚îÇ   ‚îú‚îÄ‚îÄ storage/             # –•—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ SQLiteStorage.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AsyncStorage.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ MMKVStorage.ts
‚îÇ   ‚îú‚îÄ‚îÄ api/                 # API –∫–ª–∏–µ–Ω—Ç—ã (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ SudokuApiClient.ts
‚îÇ   ‚îî‚îÄ‚îÄ di/                  # Dependency Injection
‚îÇ       ‚îú‚îÄ‚îÄ Container.ts
‚îÇ       ‚îî‚îÄ‚îÄ ServiceRegistration.ts
‚îÇ
‚îú‚îÄ‚îÄ presentation/             # –°–ª–æ–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ screens/             # –≠–∫—Ä–∞–Ω—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Home/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ HomeScreen.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ DifficultySelectionScreen.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ SavedGamesScreen.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Game/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ GameScreen.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ PauseScreen.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ VictoryScreen.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Settings/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ SettingsScreen.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ThemeSelectionScreen.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ AboutScreen.tsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Statistics/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ StatisticsScreen.tsx
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ AchievementsScreen.tsx
‚îÇ   ‚îú‚îÄ‚îÄ components/          # React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ui/             # –ë–∞–∑–æ–≤—ã–µ UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Button.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Input.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Modal.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ LoadingSpinner.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ game/           # –ò–≥—Ä–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ SudokuBoard.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ SudokuCell.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ NumberPad.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ GameHeader.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ GameControls.tsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ common/         # –û–±—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ ScreenContainer.tsx
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ Header.tsx
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ ErrorBoundary.tsx
‚îÇ   ‚îú‚îÄ‚îÄ navigation/          # –ù–∞–≤–∏–≥–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AppNavigator.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ StackNavigators.tsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ TabNavigators.tsx
‚îÇ   ‚îú‚îÄ‚îÄ hooks/               # Custom hooks
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useGame.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useTimer.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useAnalytics.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ useKeyboard.ts
‚îÇ   ‚îî‚îÄ‚îÄ styles/              # –°—Ç–∏–ª–∏
‚îÇ       ‚îú‚îÄ‚îÄ themes.ts
‚îÇ       ‚îú‚îÄ‚îÄ colors.ts
‚îÇ       ‚îú‚îÄ‚îÄ typography.ts
‚îÇ       ‚îî‚îÄ‚îÄ dimensions.ts
‚îÇ
‚îú‚îÄ‚îÄ shared/                   # –û–±—â–∏–π –∫–æ–¥
‚îÇ   ‚îú‚îÄ‚îÄ constants/           # –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ GameConstants.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ StorageKeys.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ AnalyticsEvents.ts
‚îÇ   ‚îú‚îÄ‚îÄ utils/               # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ gameLogic.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dateUtils.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ validation.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ formatting.ts
‚îÇ   ‚îú‚îÄ‚îÄ types/               # TypeScript —Ç–∏–ø—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ navigation.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ storage.ts
‚îÇ   ‚îî‚îÄ‚îÄ localization/        # –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è
‚îÇ       ‚îú‚îÄ‚îÄ i18n.ts
‚îÇ       ‚îú‚îÄ‚îÄ locales/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ en.json
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ ru.json
‚îÇ       ‚îî‚îÄ‚îÄ types.ts
‚îÇ
‚îî‚îÄ‚îÄ assets/                   # –†–µ—Å—É—Ä—Å—ã
    ‚îú‚îÄ‚îÄ images/
    ‚îú‚îÄ‚îÄ icons/
    ‚îú‚îÄ‚îÄ fonts/
    ‚îî‚îÄ‚îÄ sounds/
```

---

## 5. –ü–∞—Ç—Ç–µ—Ä–Ω—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º

### 5.1 Zustand Store Architecture

```typescript
// application/stores/types.ts
export interface AppState {
  game: GameState;
  settings: SettingsState;
  statistics: StatisticsState;
  ui: UIState;
}

export interface GameState {
  currentGame: GameEntity | null;
  selectedCell: CellPosition | null;
  gameHistory: GameMove[];
  gameTimer: number;
  isPaused: boolean;
  showHints: boolean;
  showErrors: boolean;
}

// application/stores/createGameSlice.ts
export const createGameSlice: StateCreator<AppState, [], [], GameState> = (set, get) => ({
  currentGame: null,
  selectedCell: null,
  gameHistory: [],
  gameTimer: 0,
  isPaused: false,
  showHints: true,
  showErrors: true,

  // Actions
  startNewGame: async (difficulty: DifficultyLevel) => {
    const useCase = container.resolve(StartNewGameUseCase);
    const game = await useCase.execute(difficulty);

    set((state) => ({
      ...state,
      game: {
        ...state.game,
        currentGame: game,
        gameHistory: [],
        gameTimer: 0,
        isPaused: false
      }
    }));
  },

  makeMove: async (row: number, col: number, value: number) => {
    const useCase = container.resolve(MakeMoveUseCase);
    const { currentGame } = get().game;

    if (!currentGame) return;

    const result = await useCase.execute(currentGame.id, row, col, value);

    if (result.success) {
      set((state) => ({
        ...state,
        game: {
          ...state.game,
          currentGame: result.game,
          gameHistory: [...state.game.gameHistory, {
            row, col, value, timestamp: new Date()
          }]
        }
      }));
    }
  }
});

// application/stores/useAppStore.ts
export const useAppStore = create<AppState>()(
  devtools(
    persist(
      (...args) => ({
        game: createGameSlice(...args),
        settings: createSettingsSlice(...args),
        statistics: createStatisticsSlice(...args),
        ui: createUISlice(...args)
      }),
      {
        name: 'sudoku-app-store',
        partialize: (state) => ({
          settings: state.settings,
          statistics: state.statistics
        })
      }
    ),
    { name: 'sudoku-store' }
  )
);
```

### 5.2 Error Handling Pattern

```typescript
// shared/types/Result.ts
export type Result<T, E = Error> = {
  success: true;
  data: T;
} | {
  success: false;
  error: E;
};

// application/usecases/base/BaseUseCase.ts
export abstract class BaseUseCase<TRequest, TResponse> {
  abstract execute(request: TRequest): Promise<Result<TResponse>>;

  protected handleError(error: unknown): Result<never> {
    if (error instanceof DomainError) {
      return { success: false, error };
    }

    return { success: false, error: new UnknownError('An unexpected error occurred') };
  }
}

// domain/errors/DomainErrors.ts
export abstract class DomainError extends Error {
  abstract readonly code: string;
}

export class InvalidMoveError extends DomainError {
  readonly code = 'INVALID_MOVE';
  constructor(message: string) {
    super(message);
  }
}

export class GameNotFoundError extends DomainError {
  readonly code = 'GAME_NOT_FOUND';
  constructor(gameId: string) {
    super(`Game with id ${gameId} not found`);
  }
}
```

---

## 6. –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏

### 6.1 –î–∏–∞–≥—Ä–∞–º–º–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    PRESENTATION LAYER                   ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  Screens     ‚îÇ  Components   ‚îÇ  Navigation  ‚îÇ  Hooks     ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê‚îÇ
‚îÇ  ‚îÇGameScreen‚îÇ ‚îÇ  ‚îÇSudokuCell‚îÇ  ‚îÇ  ‚îÇNavigator‚îÇ ‚îÇ ‚îÇuseGame ‚îÇ‚îÇ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                              ‚Üï
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                   APPLICATION LAYER                     ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ   Use Cases    ‚îÇ    Stores     ‚îÇ    Services           ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇStartNewGame‚îÇ ‚îÇ  ‚îÇGameStore‚îÇ  ‚îÇ  ‚îÇLocalizationSvc ‚îÇ   ‚îÇ
‚îÇ  ‚îÇMakeMove   ‚îÇ ‚îÇ  ‚îÇSettings ‚îÇ  ‚îÇ  ‚îÇTimerService    ‚îÇ   ‚îÇ
‚îÇ  ‚îÇSaveGame   ‚îÇ ‚îÇ  ‚îÇStatistics‚îÇ  ‚îÇ  ‚îÇAnalyticsService‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                              ‚Üï
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                     DOMAIN LAYER                        ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ   Entities     ‚îÇ    Rules      ‚îÇ    Interfaces          ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇGame     ‚îÇ   ‚îÇ  ‚îÇSudokuRules‚îÇ  ‚îÇ  ‚îÇIGameRepository ‚îÇ   ‚îÇ
‚îÇ  ‚îÇCell     ‚îÇ   ‚îÇ  ‚îÇDifficulty ‚îÇ  ‚îÇ  ‚îÇIPuzzleGenerator‚îÇ   ‚îÇ
‚îÇ  ‚îÇStatistics‚îÇ   ‚îÇ  ‚îÇValidation ‚îÇ  ‚îÇ  ‚îÇISettingsStorage‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                              ‚Üï
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                 INFRASTRUCTURE LAYER                    ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Repositories   ‚îÇ   Services    ‚îÇ   Storage              ‚îÇ
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ ‚îÇGameRepo    ‚îÇ ‚îÇ ‚îÇPuzzleGen  ‚îÇ ‚îÇ ‚îÇSQLite   ‚îÇAsyncStore‚îÇ ‚îÇ
‚îÇ ‚îÇStatsRepo   ‚îÇ ‚îÇ ‚îÇAnalytics  ‚îÇ ‚îÇ ‚îÇMMKV     ‚îÇFileSystem‚îÇ ‚îÇ
‚îÇ ‚îÇSettingsRepo‚îÇ ‚îÇ ‚îÇCrashRep   ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ                        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 6.2 Data Flow

```typescript
// –ü—Ä–∏–º–µ—Ä –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–µ–ª–∞–µ—Ç —Ö–æ–¥
[User Input] ‚Üí [SudokuCell.onPress]
    ‚Üì
[GameScreen.handleCellPress] ‚Üí [gameStore.selectCell]
    ‚Üì
[User Input] ‚Üí [NumberPad.onNumberPress]
    ‚Üì
[GameScreen.handleNumberInput] ‚Üí [gameStore.makeMove]
    ‚Üì
[MakeMoveUseCase.execute] ‚Üí [SudokuRules.validateMove]
    ‚Üì
[GameRepository.save] ‚Üí [SQLite Database]
    ‚Üì
[Store State Update] ‚Üí [Component Re-render]
```

---

## 7. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### 7.1 –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ —Å–ª–æ—è–º

```typescript
// __tests__/domain/SudokuRules.test.ts
describe('SudokuRules', () => {
  test('should validate correct move', () => {
    const grid = generateEmptyGrid();
    const isValid = SudokuRules.validateMove(grid, 0, 0, 5);
    expect(isValid).toBe(true);
  });

  test('should reject duplicate in row', () => {
    const grid = generateGridWithDuplicateInRow();
    const isValid = SudokuRules.validateMove(grid, 0, 1, 5);
    expect(isValid).toBe(false);
  });
});

// __tests__/application/StartNewGameUseCase.test.ts
describe('StartNewGameUseCase', () => {
  let useCase: StartNewGameUseCase;
  let mockGameRepo: jest.Mocked<IGameRepository>;
  let mockPuzzleGen: jest.Mocked<IPuzzleGenerator>;

  beforeEach(() => {
    mockGameRepo = createMockGameRepository();
    mockPuzzleGen = createMockPuzzleGenerator();
    useCase = new StartNewGameUseCase(mockGameRepo, mockPuzzleGen, mockStatsRepo);
  });

  test('should create new game with generated puzzle', async () => {
    const mockPuzzle = createMockPuzzle('easy');
    mockPuzzleGen.generate.mockResolvedValue(mockPuzzle);

    const result = await useCase.execute('easy');

    expect(result.success).toBe(true);
    expect(mockGameRepo.save).toHaveBeenCalledWith(
      expect.objectContaining({
        difficulty: 'easy',
        grid: mockPuzzle.grid
      })
    );
  });
});

// __tests__/infrastructure/GameRepository.test.ts
describe('GameRepository', () => {
  let repository: GameRepository;
  let mockDatabase: jest.Mocked<SQLiteDatabase>;

  beforeEach(() => {
    mockDatabase = createMockSQLiteDatabase();
    repository = new GameRepository(mockDatabase);
  });

  test('should save game to database', async () => {
    const game = createMockGame();
    await repository.save(game);

    expect(mockDatabase.executeSql).toHaveBeenCalledWith(
      expect.stringContaining('INSERT OR REPLACE INTO games'),
      expect.arrayContaining([game.id, expect.any(String)])
    );
  });
});

// __tests__/presentation/GameScreen.test.tsx
describe('GameScreen', () => {
  test('should render sudoku board', () => {
    const mockGame = createMockGame();
    const mockStore = createMockStore({ currentGame: mockGame });

    const { getByTestId } = render(
      <GameScreen />,
      { wrapper: createTestWrapper(mockStore) }
    );

    expect(getByTestId('sudoku-board')).toBeTruthy();
  });

  test('should handle cell press', () => {
    const mockGame = createMockGame();
    const mockSelectCell = jest.fn();
    const mockStore = createMockStore({
      currentGame: mockGame,
      selectCell: mockSelectCell
    });

    const { getByTestId } = render(
      <GameScreen />,
      { wrapper: createTestWrapper(mockStore) }
    );

    fireEvent.press(getByTestId('cell-0-0'));
    expect(mockSelectCell).toHaveBeenCalledWith(0, 0);
  });
});
```

### 7.2 Integration Tests

```typescript
// __tests__/integration/GameFlow.test.ts
describe('Game Flow Integration', () => {
  let container: DIContainer;

  beforeEach(async () => {
    container = new DIContainer();
    await setupTestDI(container);
  });

  test('should complete full game flow', async () => {
    // 1. Start new game
    const startGameUseCase = container.resolve(StartNewGameUseCase);
    const game = await startGameUseCase.execute('easy');

    // 2. Make valid moves
    const makeMoveUseCase = container.resolve(MakeMoveUseCase);
    const result = await makeMoveUseCase.execute(game.id, 0, 0, 5);

    // 3. Verify state
    expect(result.success).toBe(true);

    // 4. Check game saved
    const gameRepo = container.resolve('IGameRepository');
    const savedGame = await gameRepo.findById(game.id);
    expect(savedGame?.grid[0][0]).toBe(5);
  });
});
```

---

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å—á–∏—Ç–∞–µ—Ç—Å—è –≥–æ—Ç–æ–≤–æ–π, –∫–æ–≥–¥–∞:**
1. ‚úÖ –û–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤—Å–µ —Å–ª–æ–∏ –∏ –∏—Ö –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
2. ‚úÖ –°–æ–∑–¥–∞–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
3. ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω Dependency Injection
4. ‚úÖ –û–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –ø–∞—Ç—Ç–µ—Ä–Ω—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º
5. ‚úÖ –°–æ–∑–¥–∞–Ω—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –¥–ª—è –≤—Å–µ—Ö –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
6. ‚úÖ –û–ø—Ä–µ–¥–µ–ª–µ–Ω—ã —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
7. ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö
8. ‚úÖ –°–æ–∑–¥–∞–Ω—ã –¥–∏–∞–≥—Ä–∞–º–º—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã:
1. **2.1.4** - –í—ã–±–æ—Ä –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è
2. **2.1.5** - –í—ã–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
3. **2.2.1** - –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏–∞–≥—Ä–∞–º–º—ã –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
4. **3.1.1** - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ –∏ —Å—Ä–µ–¥—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: 19 —Å–µ–Ω—Ç—è–±—Ä—è 2025
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ